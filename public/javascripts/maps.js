'use strict';var map,infoWindow,service,currentLocation;function loadMap(){currentLocation={lat:49.278628,lng:-122.920355},map=new google.maps.Map(document.getElementById('map'),{center:currentLocation,zoom:12,scaleControl:!0,mapTypeId:'roadmap'}),infoWindow=new google.maps.InfoWindow({maxWidth:250});var a=document.getElementById('pac-input'),b=new google.maps.places.SearchBox(a);map.controls[google.maps.ControlPosition.TOP].push(a),map.addListener('bounds_changed',function(){b.setBounds(map.getBounds()),findLocations(map.getCenter())}),b.addListener('places_changed',function(){var c=b.getPlaces();if(0!=c.length){var d=new google.maps.LatLngBounds;c.forEach(function(e){return e.geometry?void(e.geometry.viewport?d.union(e.geometry.viewport):d.extend(e.geometry.location),findLocations(e.geometry.location)):void console.log('Returned place contains no geometry')}),map.fitBounds(d)}}),navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(c){var d={lat:c.coords.latitude,lng:c.coords.longitude},f=new google.maps.Marker({position:d,map:map,icon:'http://i.stack.imgur.com/orZ4x.png'});infoWindow.setPosition(d),infoWindow.setContent('You are here.'),infoWindow.open(map),setTimeout(function(){infoWindow.close()},'3000'),map.setCenter(d),findLocations(d)})}function findLocations(a){service=new google.maps.places.PlacesService(map),service.nearbySearch({location:a,radius:1e3,types:['park']},callback)}function callback(a,b){if(b==google.maps.places.PlacesServiceStatus.OK)for(var c=0;c<a.length;c++)createMarker(a[c])}function createMarker(a){var b=new google.maps.Marker({position:a.geometry.location,map:map,title:a.name}),c={reference:a.reference};service.getDetails(c,function(d){null==d&&b.setMap(null),google.maps.event.addListener(b,'click',function(){var f=[];f[0]=b.getPosition().lng(),f[1]=b.getPosition().lat();var g=JSON.stringify(f);$('#map-input').attr('value',g),d.website?infoWindow.setContent('<strong>'+d.name+'</strong><br />'+d.formatted_address+'<br /><a class="links" target="_blank" href='+d.website+'>'+d.website+'</a><br /><a class="links" target="_blank" href=https://www.google.com/maps/dir//'+f[1]+','+f[0]+'>Get Directions</a>'):infoWindow.setContent('<strong>'+d.name+'</strong><br />'+d.formatted_address+'<br /><a class="links" target="_blank" href=https://www.google.com/maps/dir//'+f[1]+','+f[0]+'>Get Directions</a>'),infoWindow.open(map,this),$('#locationName').val(d.name),$('#locationAddress').val(d.formatted_address)})})}
